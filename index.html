<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸ”¥ 100 Day AI Challenge PRO</title>

<style>
body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:sans-serif;
  text-align:center;
}
.card{
  background:#111;
  padding:20px;
  border-radius:15px;
  margin:20px;
}
button{
  padding:10px 20px;
  border-radius:8px;
  border:none;
  background:#fff;
  color:#000;
  font-weight:bold;
  cursor:pointer;
}
button:hover{
  opacity:0.8;
}
input,select{
  padding:10px;
  border-radius:8px;
  border:none;
}
</style>
</head>

<body>

<div id="login">
<h1>ðŸ”¥ 100 Day AI PRO</h1>
<button id="googleLogin">Sign in with Google</button>
</div>

<div id="app" style="display:none;">

<div class="card">
<select id="goal">
<option>Gym Transformation</option>
<option>Personality Development</option>
<option>Discipline Building</option>
<option>Custom Growth</option>
</select>
<button id="startBtn">Start Challenge</button>
</div>

<div class="card">
<h2 id="day"></h2>
<p id="task"></p>
<button id="completeBtn">Complete Today</button>
<p id="ai"></p>
</div>

<div class="card">
<p id="streak"></p>
<p id="progress"></p>
<button id="weeklyBtn">Weekly Report</button>
</div>

<div class="card">
<button id="logoutBtn">Logout</button>
</div>

</div>

<script type="module">

import { initializeApp } 
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";

import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged, signOut } 
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

import { getFirestore, doc, setDoc, getDoc, updateDoc, arrayUnion } 
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

/* ðŸ”¥ REPLACE THESE WITH YOUR REAL FIREBASE VALUES */
const firebaseConfig = {
  apiKey: "PASTE_API_KEY",
  authDomain: "yourproject.firebaseapp.com",
  projectId: "yourproject",
  storageBucket: "yourproject.appspot.com",
  messagingSenderId: "PASTE_SENDER_ID",
  appId: "PASTE_APP_ID"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const provider = new GoogleAuthProvider();

let user = null;

/* ================= LOGIN ================= */

document.getElementById("googleLogin").addEventListener("click", async () => {
  try{
    await signInWithPopup(auth, provider);
  }catch(err){
    alert(err.message);
  }
});

/* ================= LOGOUT ================= */

document.getElementById("logoutBtn").addEventListener("click", async () => {
  await signOut(auth);
});

/* ================= AUTH STATE ================= */

onAuthStateChanged(auth, async (u) => {
  if (u) {
    user = u;
    document.getElementById("login").style.display="none";
    document.getElementById("app").style.display="block";
    loadChallenge();
  } else {
    document.getElementById("login").style.display="block";
    document.getElementById("app").style.display="none";
  }
});

/* ================= START ================= */

document.getElementById("startBtn").addEventListener("click", async () => {

  if(!user) return alert("Login first.");

  const goal = document.getElementById("goal").value;

  await setDoc(doc(db,"users",user.uid),{
    goal:goal,
    currentDay:1,
    streak:0,
    completed:[],
    created:new Date()
  });

  loadChallenge();
});

/* ================= LOAD ================= */

async function loadChallenge(){

  if(!user) return;

  const snap = await getDoc(doc(db,"users",user.uid));
  if(!snap.exists()) return;

  const data = snap.data();

  document.getElementById("day").innerText = "Day " + data.currentDay;
  document.getElementById("task").innerText = "Today's mission for: " + data.goal;
  document.getElementById("streak").innerText = "ðŸ”¥ Streak: " + data.streak;

  const percent = Math.floor((data.completed.length / 100) * 100);
  document.getElementById("progress").innerText = "Progress: " + percent + "%";
}

/* ================= COMPLETE DAY ================= */

document.getElementById("completeBtn").addEventListener("click", async () => {

  if(!user) return;

  const ref = doc(db,"users",user.uid);
  const snap = await getDoc(ref);
  const data = snap.data();

  await updateDoc(ref,{
    currentDay:data.currentDay + 1,
    streak:data.streak + 1,
    completed:arrayUnion(data.currentDay)
  });

  document.getElementById("ai").innerText = 
    "ðŸ”¥ Strong work! Keep building momentum.";

  loadChallenge();
});

/* ================= WEEKLY REPORT ================= */

document.getElementById("weeklyBtn").addEventListener("click", async () => {

  if(!user) return;

  const snap = await getDoc(doc(db,"users",user.uid));
  const data = snap.data();

  alert("You have completed " + data.completed.length + " days so far.");
});

</script>

</body>
</html>
